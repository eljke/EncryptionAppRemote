<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Сохранённые результаты</title>
    <style>
        h2 {
            margin-top: 1% !important;
            margin-left: 1%;
        }
        table, th, td {
            border: 3px solid #000000;
            border-collapse: collapse;
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</head>
<body>
<div>
    <h2>Сохранённые результаты</h2>
    <br>
    <table class="table">
        <thead>
        <tr>
            <th scope="col">№</th>
            <th scope="col">Алгоритм</th>
            <th scope="col">Параметры алгоритма</th>
            <th scope="col">Значение до шифрования</th>
            <th scope="col">Зашифрованное значение</th>
            <th scope="col">Дата и время шифрования</th>
        </tr>
        </thead>
        <tbody th:each="result, counter : ${results}">
        <tr th:class="${'table-' +
                    result.encodeRequest.algorithm.toLowerCase()
                    + ' ' +
                    (result.encodeRequest.algorithm == 'CAESAR' ? 'table-primary' :
                    (result.encodeRequest.algorithm == 'HYPOTENUSE' ? 'table-secondary' :
                    (result.encodeRequest.algorithm == 'BCRYPT' ? 'table-success' :
                    (result.encodeRequest.algorithm == 'VIGENERE' ? 'table-danger' :
                    (result.encodeRequest.algorithm == 'SUBSTITUTION' ? 'table-warning' :
                    (result.encodeRequest.algorithm == 'TABULAR_ROUTE_SHUFFLE' ? 'table-info' :
                    (result.encodeRequest.algorithm == 'POLYBIUS_SQUARE' ? 'table-light' : 'table-dark')))))))}">
            <th scope="col" th:text="${counter.count}"></th>
            <td>
                <span th:switch="${result.encodeRequest.algorithm}">
                    <span th:case="'CAESAR'">Шифр Цезаря</span>
                    <span th:case="'HYPOTENUSE'">Метод гипотенузы</span>
                    <span th:case="'BCRYPT'">Bcrypt хэш-функция</span>
                    <span th:case="'VIGENERE'">Шифр Виженера</span>
                    <span th:case="'SUBSTITUTION'">Шифр подстановки</span>
                    <span th:case="'TABULAR_ROUTE_SHUFFLE'">Шифр табличной маршрутной перестановки</span>
                    <span th:case="'POLYBIUS_SQUARE'">Квадрат Полибия</span>
                    <span th:case="*" th:text="${result.encodeRequest.algorithm}"></span>
                </span>
            </td>
            <td>
                <span th:switch="${result.encodeRequest.algorithm}">
                    <span th:case="'CAESAR'">
                        <span th:if="${result.encodeRequest.params[0].get(0) != ''}">
                            <span th:text="'Смещение = ' + ${result.encodeRequest.params[0].get(0)}"></span>
                        </span>
                    </span>
                    <span th:case="'HYPOTENUSE'">
                        <span th:if="${result.encodeRequest.params[0].get(0) != ''}">
                            <span th:text="'Катет 1 = ' + ${result.encodeRequest.params[0].get(0)}"></span>
                        </span>
                        <span th:if="${result.encodeRequest.params[0].get(1) != ''}">
                            <span th:text="', катет 2 = ' + ${result.encodeRequest.params[0].get(1)}"></span>
                        </span>
                        <span th:if="${result.encodeRequest.params[0].get(2) != ''}">
                            <span th:text="', количество раундов = ' + ${result.encodeRequest.params[0].get(2)}"></span>
                        </span>
                        <span th:if="${result.encodeRequest.params[0].get(3) != ''}">
                            <span th:text="', алфавит = ' +
                                ${result.encodeRequest.params[0].get(3) == 'RU' ? 'русский' :
                                  (result.encodeRequest.params[0].get(3) == 'EN' ? 'английский' : '')}">
                            </span>
                        </span>
                    </span>
                    <span th:case="'BCRYPT'">
                        <span th:if="${result.encodeRequest.params[0].get(0) != ''}">
                            <span th:text="'Сложность = ' + ${result.encodeRequest.params[0].get(0)}"></span>
                        </span>
                    </span>
                    <span th:case="'VIGENERE'">
                        <span th:if="${result.encodeRequest.params[0].get(0) != ''}">
                            <span th:text="'Ключ = ' + ${result.encodeRequest.params[0].get(0)}"></span>
                        </span>
                    </span>
                    <span th:case="'SUBSTITUTION'">
                        <span th:if="${result.encodeRequest.params[0].get(0) != ''}">
                            <span th:text="'Замены:'"></span>
                            <span>
                                <script th:inline="javascript">
                                    const substitutions = /*[[${result.encodeRequest.params[0]}]]*/ '';
                                    const substitutionsObj = JSON.parse(substitutions);
                                    let counter = 1;

                                    for (const key in substitutionsObj) {
                                        if (substitutionsObj.hasOwnProperty(key)) {
                                            document.write('<br>')
                                            document.write(counter + ') ' + key + ' -> ' + substitutionsObj[key]);
                                            counter++;
                                        }
                                    }
                                </script>
                            </span>
                        </span>
                    </span>
                    <span th:case="'TABULAR_ROUTE_SHUFFLE'">
                        <span th:if="${result.encodeRequest.params[0].get(0) != ''}">
                            <span th:text="'Количество строк = ' + ${result.encodeRequest.params[0].get(0)}"></span>
                        </span>
                        <span th:if="${result.encodeRequest.params[0].get(1) != ''}">
                            <span th:text="', количество столбцов = ' + ${result.encodeRequest.params[0].get(1)}"></span>
                        </span>
                         <span th:if="${result.encodeRequest.params[0].get(2) != ''}">
                            <span th:text="', маршрут выписывания = ' +
                                ${result.encodeRequest.params[0].get(2) == 'UL' ? 'сверху-вниз слева-направо' :
                                  (result.encodeRequest.params[0].get(2) == 'DR' ? 'снизу-вверх справа-налево' :
                                    (result.encodeRequest.params[0].get(2) == 'RD' ? 'справа-налево снизу-вверх' : ''))}">
                            </span>
                         </span>
                    </span>
                    <span th:case="'POLYBIUS_SQUARE'">
                        <span th:if="${result.encodeRequest.params[0].get(0) != ''}">
                            <span th:text="'Алфавит = ' +
                                ${result.encodeRequest.params[0].get(0) == 'RU' ? 'русский' :
                                  (result.encodeRequest.params[0].get(0) == 'EN' ? 'английский' : '')}">
                            </span>
                        </span>
                    </span>
                    <span th:case="*" th:text="${result.encodeRequest.params}"></span>
                </span>
            </td>
            <td th:text="${result.encodeRequest.value}"></td>
            <td th:text="${result.encodedValue}"></td>
            <td th:text="${result.date}"></td>
        </tr>
        </tbody>
    </table>
</div>
</body>
</html>